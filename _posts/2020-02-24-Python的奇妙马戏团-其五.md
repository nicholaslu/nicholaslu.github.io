---
layout: post
title: "Python的奇妙马戏团-其五"
date: 2020-02-24 23:57:45
categories: Python
---

# 斐波那契数列

斐波那契数列是我们很喜欢的一个数列，这不仅是因为它的奇妙的数学性质，也是因为它是由递归的方式来计算的。我们一般定义这个数列的第0项为0，第1项为1，此后的每一项都等于前两项的和。

这种重复的计算是计算机所擅长的，如果让人类计算斐波那契数列，可能算个几十项就算不下去了，而且其中一项算错的话，后面全都会出错。所以试着用Python计算一下斐波那契数列吧，此处计算前五十项。

```python
fib0 = 0
fib1 = 1
print(fib0,"\n")
print(fib1,"\n")
for i in range(2,51):
    fib0, fib1 = fib1, fib0 + fib1
    print(fib1,"\n")
```

`fib0, fib1 = fib1, fib0+fib1`这一句体现了Python比较方便的一点，可以同时给多个变量**同时**赋值。在很多语言中，一次只能给一个变量赋值，一个经典问题是，如何交换`a`和`b`的值。在C之类的语言中，你需要这么做

```python
t = b
b = a
a = t
```

而在Python中，可以这样

```python
a, b = b, a
```

# 斐波那契数列函数

我们之前用了很多函数，比如`print()`函数、`range()`函数。函数的作用是对于输入，给出对应的输出。我们已经可以计算斐波那契数列的某一项的值了，如果我经常在自己的程序中用到斐波那契数列的值，应该怎么办？每次都加一遍上面的代码吗，显然太繁琐。此时可以考虑把这段代码改成一个函数，以后每次使用这个函数就好。

在构建一个函数的时候，我们需要确定的是：输入、输出和函数名。输入在使用这个函数的时候传递给函数，一般被称为这个函数的参数，可以有多个参数，用`,`隔开。输出在函数的本体用`return`语句给出，输出是可选的。函数名要注意意义明确，并且避免和内建函数重名。

把斐波那契数列的计算函数化时，输入和输出应该是什么呢。`for i in range(2,51):`这一句中的`25`决定了计算到哪一项，所以这就应该由函数的参数给出。`fib1`的值是每次打印的值，这个值应该返回。

```python
def fib(n):
    fib0 = 0
    fib1 = 1
    for i in range(2,n):
        fib0, fib1 = fib1, fib0+fib1
    return fib1

print(fib(int(input())))
```

最后一句就是对斐波那契数列函数`fib()`的调用了。

只要有初始的两个值，就可以计算出后面的所有的值，计算方式也非常明确，那么有没有什么方法可以利用这个特性呢？由于函数可以调用自己，于是便有一种优雅的方式计算斐波那契数列。

```python
def fib(n):
    if n == 0:
        return 0
    elif n == 1:
        return 1
    else:
        return fib(n-1) + fib(n-2)

print(fib(int(input())))
```

这个函数和上面的函数会给出一样的答案，但是，仅当要计算的是第0项或是第1项时这个函数可以直接给出，在计算其他的项的时候，这个函数会调用自身计算前面的两项，而前面的两项的计算又调用了更前面的四项，分支越来越多，直到全部都调用到了第0项或是第1项为止。也许还无法看出来，但这个方法虽然优雅，但并不高效，其原因就是在反复的调用中产生了非常多的不必要的计算。你可以用上面的两种方法各计算一遍第100项尝试一下。

# 一个正数的平方根的整数部分是多少？

在中学数学中，对如何估算一个正数的平方根有所介绍，其主要思想是找出最小的比这个数大的完全平方数和最大的比这个数小的完全平方数，这个数的平方根便介于这两个数的平方根之间（其实找到这两个中的一个即可，因为两者差一定为1）。用这种方法，我们可以快速计算出任何一个正数的平方根的整数部分。

如果从零为起点，向正方向去寻找的话，我们比较难判断目前取得的是不是最大的比这个数小的完全平方数，但是第一个出现的比这个数大的完全平方数一定是最小的那一个。因此我们寻找的是第一个比这个数大的完全平方数。

对于输入，我们应该注意应该要保证它大于等于0。对于求平方根的数恰好为完全平方数这种边界情况也应该注意。下边这个函数`rootSolInt`可供参考。

```python
def rootSolInt(n):
    "Input shall be greater than or equal to zero."
    if n < 0:
        return -1
    else:
        i = 1
        while True:
            if ( n < i*i ):
                return i-1
            else:
                i = i+1
                
n = int(input("INPUT THE NUMBER TO BE CALCULATED: "))
print(rootSolInt(n))
```

# 使用牛顿法计算更精确的平方根